<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MCCs · TreeKnit documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TreeKnit documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Index</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>MCCs</a><ul class="internal"><li><a class="tocitem" href="#Handling-trees"><span>Handling trees</span></a></li><li><a class="tocitem" href="#Simple-case"><span>Simple case</span></a></li><li><a class="tocitem" href="#Interpretation-of-results"><span>Interpretation of results</span></a></li><li><a class="tocitem" href="#naive_mccs"><span>Naive estimation</span></a></li></ul></li><li><a class="tocitem" href="../options/">Important options</a></li><li><a class="tocitem" href="../multitreeknit/">MultiTreeKnit</a></li><li><a class="tocitem" href="../visualization/">Visualizing MCCs</a></li></ul></li><li><span class="tocitem">Under the hood</span><ul><li><a class="tocitem" href="../opttrees/"><code>opttrees</code></a></li><li><a class="tocitem" href="../runopt/"><code>runopt</code></a></li><li><a class="tocitem" href="../resolving/">Resolving</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../types/">Objects</a></li><li><a class="tocitem" href="../functions/">Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>MCCs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MCCs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PierreBarrat/TreeKnit.jl/blob/master/docs/src/mccs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MCCs"><a class="docs-heading-anchor" href="#MCCs">Maximally Compatible Clades</a><a id="MCCs-1"></a><a class="docs-heading-anchor-permalink" href="#MCCs" title="Permalink"></a></h1><p><em>TreeKnit</em> reconstructs the ARG from trees by first inferring (topologically) shared regions of the tree, so called Maximally Compatible Clades (MCC). By default if they share the same topology up to <a href="../resolving/#resolving">resolution</a> TreeKnit will assume the region is shared. </p><h2 id="Handling-trees"><a class="docs-heading-anchor" href="#Handling-trees">Handling trees</a><a id="Handling-trees-1"></a><a class="docs-heading-anchor-permalink" href="#Handling-trees" title="Permalink"></a></h2><p>Functions that directly handle trees are found in the separate <em>TreeTools</em> package, see its <a href="https://pierrebarrat.github.io/TreeTools.jl/dev/">documentation</a>.   Here are two useful ones: </p><ul><li><code>read_tree(file)</code>: read tree from newick file, return <code>Tree</code> object. </li><li><code>parse_newick_string(string)</code>: parse newick <code>string</code> into a <code>Tree</code> object. For convenience, this one is re-exported by TreeKnit. </li></ul><h2 id="Simple-case"><a class="docs-heading-anchor" href="#Simple-case">Simple case</a><a id="Simple-case-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-case" title="Permalink"></a></h2><p>Let&#39;s see how to infer Maximally Compatible Clades (MCC) for a very simple case: two trees with five leaves. </p><pre><code class="language-julia hljs">using TreeKnit
t1 = parse_newick_string(&quot;((A,B),(C,(D,X)));&quot;; label=&quot;t1&quot;)
t2 = parse_newick_string(&quot;((A,(B,X)),(C,D));&quot;; label=&quot;t2&quot;)</code></pre><p>The <code>run_treeknit!</code> function takes two trees as input. </p><pre><code class="language-julia hljs">mccs = run_treeknit!(t1, t2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MCC_set(2, [&quot;t1&quot;, &quot;t2&quot;], Dict{Set{String}, Vector{Vector{String}}}(Set([&quot;t2&quot;, &quot;t1&quot;]) =&gt; [[&quot;X&quot;], [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;]]))</code></pre><p>The output is an <code>MCC_set</code> object, which contains three fields:</p><ul><li><code>no_trees</code>: number of trees</li><li><code>order_trees</code>: Vector of tree labels, determines later order of calculations on tree pairs</li><li><code>mccs</code>: Dictionary of calculated mccs, the key is a set of labels of trees in each tree pair, the Individual MCCs are simply arrays containing labels of leaves of the trees. For example the array <code>[&quot;X&quot;]</code> corresponds to the MCC which contains the leaf <code>&quot;X&quot;</code>.</li></ul><h2 id="Interpretation-of-results"><a class="docs-heading-anchor" href="#Interpretation-of-results">Interpretation of results</a><a id="Interpretation-of-results-1"></a><a class="docs-heading-anchor-permalink" href="#Interpretation-of-results" title="Permalink"></a></h2><p>The genealogy of two RNA segments subject to reassortment is described by an Ancestral Reassortment Graph (ARG).  An ARG is a directed graph that represents the lineage of a given pair of segments by coalescence of nodes, as in a genealogical tree, but also shows reassortment events and the exchange of segments by nodes that have two ancestors.  Since reassortments only occur between segments, the genealogy of a given segment is described by a tree.  As a result, the ARG must embed both segment-trees, and every branch in the ARG has to belong to either one of the trees, or to both. </p><p><em>TreeKnit</em> infers the ARG by finding the branches that are common to both trees.  Given two trees with potentially different topologies, it tries to &quot;glue&quot; them together in a reasonable way, where the interpretation of reasonable can vary between <em>parsimonious</em> and <em>conservative</em> (see the <a href="../options/#gamma">parsimony parameter</a> <span>$\gamma$</span>). </p><p>The MCCs returned by <code>run_treeknit!</code> represent regions of the ARG (and of the segment trees) where branches are common to both trees.  In other words, these are the regions where the two segment trees must be &quot;glued together&quot;.  Given those regions and the knowledge of the trees, it is possible to unambiguously reconstruct the genealogy. </p><div class="admonition is-info"><header class="admonition-header">Number of reassortments in the genealogy</header><div class="admonition-body"><p>When going up the ARG (backwards in time), a reassortment consists of passing from a region where branches are common to the two trees to a region where they are not. It is a <em>split</em> of branches.  As a consequence, the root of each MCC must be a reassortment, <em>with the exception</em> of an MCC containing the root of both trees.  The number of reassortments events in the inferred ARG can thus simply be obtained by counting the number of MCCs, potentially removing the one that contains the roots of both trees if it exists. </p></div></div><h2 id="naive_mccs"><a class="docs-heading-anchor" href="#naive_mccs">Naive estimation</a><a id="naive_mccs-1"></a><a class="docs-heading-anchor-permalink" href="#naive_mccs" title="Permalink"></a></h2><p>It is also possible to compute a &quot;naive&quot; estimation of MCCs using the <code>naive</code> keyword.    When <code>naive</code> is set to <code>true</code>, <code>run_treeknit!</code> returns maximum clades that are exactly compatible between pairs of trees: </p><pre><code class="language- hljs">using TreeKnit # hide
t1 = parse_newick_string(&quot;(((A1,A2),(B1,B2)),(C1,C2));&quot;; label=&quot;t1&quot;)
t2 = parse_newick_string(&quot;(((A1,A2),(C1,C2)),(B1,B2));&quot;; label=&quot;t2&quot;)
run_treeknit!(t1, t2; naive=true)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../options/">Important options »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 28 May 2023 14:45">Sunday 28 May 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
